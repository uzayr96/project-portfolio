<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction – UZAIR AHMED</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-588a8d7f314547d72466d2c244bcbf57.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="custom.css">
<meta property="og:title" content="Introduction – UZAIR AHMED">
<meta property="og:description" content="">
<meta property="og:image" content="Mask Detection_files/figure-html/cell-5-output-1.png">
<meta property="og:site_name" content="UZAIR AHMED">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">UZAIR AHMED</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project.html"> 
<span class="menu-text">Project Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">Résumé &amp; Credentials</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://www.linkedin.com/in/uzairahmed1996/" title="LinkedIn" class="quarto-navigation-tool px-1" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>With the spread of covid-19, people are advised to wear mask in order to protect themselves from spread of the virus. Governments have made mandatory to wear the mask. Now the question is how government can ensure that all people wear mask? With the help of artificial intelligence, governments are able to track people. In this project, with the help of Adrian Rosebrock, PhD guidance, I was able to make mask detector based on deep learning. I have taken pictures from pyimage tutorial and google.</p>
<section id="importing-packages" class="level1">
<h1>Importing Packages</h1>
<div id="cell-3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:45:50.266681Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:45:47.510502Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.applications.mobilenet_v2 <span class="im">import</span> preprocess_input</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> load_img, img_to_array</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> ModelCheckpoint</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelBinarizer</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> load_model</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(action <span class="op">=</span> <span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:52:21.176362Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:52:21.171377Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_path <span class="op">=</span> <span class="st">'MaskDataset'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> os.listdir(data_path)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(categories))]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>label_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(categories, labels))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(label_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Mask': 0, 'NoMask': 1}</code></pre>
</div>
</div>
</section>
<section id="loading-images-and-preprocessing" class="level1">
<h1>Loading Images and Preprocessing</h1>
<div id="cell-6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T17:56:45.761194Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T17:56:00.363858Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>image_size <span class="op">=</span> <span class="dv">224</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> []</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> []</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category <span class="kw">in</span> categories:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    folder <span class="op">=</span> os.path.join(data_path, category)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    img_names <span class="op">=</span> os.listdir(folder)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Loading Images </span><span class="sc">{}</span><span class="st"> ......"</span>.<span class="bu">format</span>(category))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> img_name <span class="kw">in</span> img_names:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>            img_path <span class="op">=</span> os.path.join(folder, img_name)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            img <span class="op">=</span> load_img(img_path, target_size<span class="op">=</span>(image_size, image_size))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            img_array <span class="op">=</span> img_to_array(img)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            img_array <span class="op">=</span> preprocess_input(img_array)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            images.append(img)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            data.append(img_array)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            target.append(label_dict[category])</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Exception: '</span>,e)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of images Loaded: '</span>, <span class="bu">len</span>(data))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading Images Mask ......
Exception:  cannot identify image file 'MaskDataset\\Mask\\desktop.ini'
Loading Images NoMask ......
Number of images Loaded:  5601</code></pre>
</div>
</div>
<section id="viewing-few-images" class="level2">
<h2 class="anchored" data-anchor-id="viewing-few-images">Viewing few images</h2>
<div id="cell-8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:01:04.327702Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:01:02.290175Z&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">5600</span>), <span class="dv">30</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,source <span class="kw">in</span> <span class="bu">enumerate</span>(n):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">5</span> , <span class="dv">6</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    plt.imshow(images[source])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Target </span><span class="sc">{</span>target[source]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">Preprocessing</h2>
<div id="cell-10" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:01:32.175440Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:01:30.564115Z&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(data)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y_array <span class="op">=</span> np.array(target)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> to_categorical(y_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:01:36.723272Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:01:36.719269Z&quot;}" data-scrolled="true" data-execution_count="26">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_array.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(5601, 224, 224, 3)
(5601,)</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:01:43.335251Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:01:41.326941Z&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(X_train, X_val_test, y_train, y_val_test) <span class="op">=</span> train_test_split(X,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                                                              y,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                                              test_size <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                                              random_state <span class="op">=</span> <span class="dv">999</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                                                              stratify <span class="op">=</span> y,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                                                              shuffle <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>(X_val, X_test, y_val, y_test) <span class="op">=</span> train_test_split(X_val_test,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                                                  y_val_test,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                                  test_size <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                                                  random_state <span class="op">=</span> <span class="dv">1234</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                                                  stratify <span class="op">=</span> y_val_test,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                                                  shuffle <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_test.shape)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_val.shape)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.shape)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_test.shape)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_val.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(3360, 224, 224, 3)
(1121, 224, 224, 3)
(1120, 224, 224, 3)
(3360, 2)
(1121, 2)
(1120, 2)</code></pre>
</div>
</div>
</section>
<section id="image-data-augmentation" class="level2">
<h2 class="anchored" data-anchor-id="image-data-augmentation">Image Data Augmentation</h2>
<p>I will use data augmentation to increase the size of the dataset by using the same image but with difference angle and zoom so that our model generalizes well.</p>
<div id="cell-14" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T14:30:55.177501Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T14:30:54.137798Z&quot;}" data-execution_count="146">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>aug <span class="op">=</span> ImageDataGenerator(rotation_range<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                         zoom_range<span class="op">=</span><span class="fl">0.15</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                         width_shift_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                         height_shift_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                         shear_range<span class="op">=</span><span class="fl">0.15</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                         horizontal_flip<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>aug.fit(X_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="deep-learning" class="level1">
<h1>Deep Learning</h1>
<div id="cell-16" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T14:30:59.926765Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T14:30:59.922742Z&quot;}" data-execution_count="147">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Flatten, Activation,Dense, Conv2D, Dropout, AveragePooling2D</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T14:31:29.630063Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T14:31:29.515361Z&quot;}" data-execution_count="150">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Parameters</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="op">=</span> <span class="fl">1e-4</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">## CNN</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">128</span>, (<span class="dv">3</span>, <span class="dv">3</span>), input_shape <span class="op">=</span> X_train.shape[<span class="dv">1</span>:]))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>model.add(Activation(<span class="st">'relu'</span>))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>model.add(AveragePooling2D(pool_size <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">128</span>, (<span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>model.add(Activation(<span class="st">'relu'</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>model.add(AveragePooling2D(pool_size <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">128</span>, (<span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>model.add(Activation(<span class="st">'relu'</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>model.add(AveragePooling2D(pool_size <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(Conv2D(64, (3, 3)))</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(Activation('relu'))</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(AveragePooling2D(pool_size = (2, 2)))</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(Conv2D(64, (3, 3)))</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(Activation('relu'))</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(AveragePooling2D(pool_size = (2, 2)))</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(Conv2D(64, (3, 3)))</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(Activation('relu'))</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(AveragePooling2D(pool_size = (2, 2)))</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">## Flatten</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>model.add(Flatten())</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">64</span>, activation <span class="op">=</span> <span class="st">'relu'</span>))</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">2</span>, activation <span class="op">=</span> <span class="st">'softmax'</span>))</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">## Compile</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>adamoptimizer <span class="op">=</span> Adam(learning_rate<span class="op">=</span>learning_rate)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> adamoptimizer,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>              loss <span class="op">=</span> <span class="st">'binary_crossentropy'</span>,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>              metrics <span class="op">=</span> [<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T14:31:34.540222Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T14:31:34.537229Z&quot;}" data-execution_count="151">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>checkpoint <span class="op">=</span> ModelCheckpoint(<span class="st">'model-</span><span class="sc">{epoch:03d}</span><span class="st">.model'</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                             monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                             verbose<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                             save_best_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T15:24:24.544876Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T14:31:39.381077Z&quot;}" data-scrolled="true" data-execution_count="152">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     X_train, y_train,</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                    aug.flow(X_train, y_train, batch_size<span class="op">=</span>batch_size),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                    steps_per_epoch <span class="op">=</span> <span class="bu">len</span>(X_train)<span class="op">//</span> batch_size,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                    validation_data <span class="op">=</span> (X_val, y_val),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                    validation_steps<span class="op">=</span><span class="bu">len</span>(X_val)<span class="op">//</span>batch_size,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                    epochs<span class="op">=</span>epochs,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                    shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                    callbacks <span class="op">=</span> [checkpoint]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 105 steps, validate on 1120 samples
Epoch 1/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.4307 - accuracy: 0.8152INFO:tensorflow:Assets written to: model-001.model\assets
105/105 [==============================] - 35s 336ms/step - loss: 0.4298 - accuracy: 0.8158 - val_loss: 0.2933 - val_accuracy: 0.8973
Epoch 2/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.3219 - accuracy: 0.8771INFO:tensorflow:Assets written to: model-002.model\assets
105/105 [==============================] - 35s 331ms/step - loss: 0.3212 - accuracy: 0.8777 - val_loss: 0.2543 - val_accuracy: 0.9089
Epoch 3/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2914 - accuracy: 0.8885INFO:tensorflow:Assets written to: model-003.model\assets
105/105 [==============================] - 35s 333ms/step - loss: 0.2911 - accuracy: 0.8890 - val_loss: 0.2231 - val_accuracy: 0.9179
Epoch 4/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2850 - accuracy: 0.8936INFO:tensorflow:Assets written to: model-004.model\assets
105/105 [==============================] - 32s 309ms/step - loss: 0.2848 - accuracy: 0.8938 - val_loss: 0.2212 - val_accuracy: 0.9187
Epoch 5/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2715 - accuracy: 0.8969INFO:tensorflow:Assets written to: model-005.model\assets
105/105 [==============================] - 33s 313ms/step - loss: 0.2726 - accuracy: 0.8967 - val_loss: 0.2181 - val_accuracy: 0.9241
Epoch 6/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2637 - accuracy: 0.9008INFO:tensorflow:Assets written to: model-006.model\assets
105/105 [==============================] - 33s 315ms/step - loss: 0.2638 - accuracy: 0.9003 - val_loss: 0.1935 - val_accuracy: 0.9295
Epoch 7/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2507 - accuracy: 0.9044INFO:tensorflow:Assets written to: model-007.model\assets
105/105 [==============================] - 34s 325ms/step - loss: 0.2507 - accuracy: 0.9045 - val_loss: 0.1872 - val_accuracy: 0.9375
Epoch 8/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2382 - accuracy: 0.9123INFO:tensorflow:Assets written to: model-008.model\assets
105/105 [==============================] - 33s 317ms/step - loss: 0.2386 - accuracy: 0.9119 - val_loss: 0.1748 - val_accuracy: 0.9393
Epoch 9/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2412 - accuracy: 0.9047INFO:tensorflow:Assets written to: model-009.model\assets
105/105 [==============================] - 33s 312ms/step - loss: 0.2409 - accuracy: 0.9051 - val_loss: 0.1713 - val_accuracy: 0.9339
Epoch 10/100
105/105 [==============================] - 31s 293ms/step - loss: 0.2266 - accuracy: 0.9152 - val_loss: 0.1774 - val_accuracy: 0.9393
Epoch 11/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.2202 - accuracy: 0.9114INFO:tensorflow:Assets written to: model-011.model\assets
105/105 [==============================] - 33s 310ms/step - loss: 0.2195 - accuracy: 0.9113 - val_loss: 0.1680 - val_accuracy: 0.9411
Epoch 12/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1957 - accuracy: 0.9315INFO:tensorflow:Assets written to: model-012.model\assets
105/105 [==============================] - 33s 317ms/step - loss: 0.1952 - accuracy: 0.9315 - val_loss: 0.1468 - val_accuracy: 0.9438
Epoch 13/100
105/105 [==============================] - 31s 291ms/step - loss: 0.2141 - accuracy: 0.9187 - val_loss: 0.1548 - val_accuracy: 0.9420
Epoch 14/100
105/105 [==============================] - 31s 292ms/step - loss: 0.1912 - accuracy: 0.9253 - val_loss: 0.1673 - val_accuracy: 0.9268
Epoch 15/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1818 - accuracy: 0.9324INFO:tensorflow:Assets written to: model-015.model\assets
105/105 [==============================] - 32s 308ms/step - loss: 0.1818 - accuracy: 0.9318 - val_loss: 0.1305 - val_accuracy: 0.9482
Epoch 16/100
105/105 [==============================] - 31s 292ms/step - loss: 0.1751 - accuracy: 0.9327 - val_loss: 0.1519 - val_accuracy: 0.9429
Epoch 17/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1776 - accuracy: 0.9300INFO:tensorflow:Assets written to: model-017.model\assets
105/105 [==============================] - 33s 312ms/step - loss: 0.1771 - accuracy: 0.9298 - val_loss: 0.1259 - val_accuracy: 0.9464
Epoch 18/100
105/105 [==============================] - 31s 293ms/step - loss: 0.1686 - accuracy: 0.9330 - val_loss: 0.1447 - val_accuracy: 0.9446
Epoch 19/100
105/105 [==============================] - 31s 292ms/step - loss: 0.1685 - accuracy: 0.9298 - val_loss: 0.1389 - val_accuracy: 0.9464
Epoch 20/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1686 - accuracy: 0.9318INFO:tensorflow:Assets written to: model-020.model\assets
105/105 [==============================] - 34s 325ms/step - loss: 0.1677 - accuracy: 0.9321 - val_loss: 0.1230 - val_accuracy: 0.9527
Epoch 21/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1635 - accuracy: 0.9315INFO:tensorflow:Assets written to: model-021.model\assets
105/105 [==============================] - 37s 353ms/step - loss: 0.1632 - accuracy: 0.9318 - val_loss: 0.1164 - val_accuracy: 0.9580
Epoch 22/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1495 - accuracy: 0.9429INFO:tensorflow:Assets written to: model-022.model\assets
105/105 [==============================] - 36s 342ms/step - loss: 0.1499 - accuracy: 0.9426 - val_loss: 0.1158 - val_accuracy: 0.9518
Epoch 23/100
105/105 [==============================] - 31s 292ms/step - loss: 0.1502 - accuracy: 0.9443 - val_loss: 0.1211 - val_accuracy: 0.9545
Epoch 24/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1436 - accuracy: 0.9450INFO:tensorflow:Assets written to: model-024.model\assets
105/105 [==============================] - 35s 338ms/step - loss: 0.1433 - accuracy: 0.9449 - val_loss: 0.1130 - val_accuracy: 0.9482
Epoch 25/100
105/105 [==============================] - 32s 304ms/step - loss: 0.1435 - accuracy: 0.9455 - val_loss: 0.1174 - val_accuracy: 0.9545
Epoch 26/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1331 - accuracy: 0.9510INFO:tensorflow:Assets written to: model-026.model\assets
105/105 [==============================] - 34s 327ms/step - loss: 0.1340 - accuracy: 0.9506 - val_loss: 0.0992 - val_accuracy: 0.9625
Epoch 27/100
105/105 [==============================] - 31s 299ms/step - loss: 0.1346 - accuracy: 0.9491 - val_loss: 0.1297 - val_accuracy: 0.9464
Epoch 28/100
105/105 [==============================] - 31s 295ms/step - loss: 0.1334 - accuracy: 0.9494 - val_loss: 0.1050 - val_accuracy: 0.9643
Epoch 29/100
105/105 [==============================] - 31s 298ms/step - loss: 0.1321 - accuracy: 0.9473 - val_loss: 0.1154 - val_accuracy: 0.9536
Epoch 30/100
105/105 [==============================] - 31s 296ms/step - loss: 0.1238 - accuracy: 0.9533 - val_loss: 0.1224 - val_accuracy: 0.9464
Epoch 31/100
105/105 [==============================] - 31s 295ms/step - loss: 0.1273 - accuracy: 0.9536 - val_loss: 0.1101 - val_accuracy: 0.9607
Epoch 32/100
105/105 [==============================] - 31s 298ms/step - loss: 0.1108 - accuracy: 0.9580 - val_loss: 0.1076 - val_accuracy: 0.9554
Epoch 33/100
105/105 [==============================] - 31s 295ms/step - loss: 0.1117 - accuracy: 0.9563 - val_loss: 0.1081 - val_accuracy: 0.9652
Epoch 34/100
105/105 [==============================] - 31s 295ms/step - loss: 0.1074 - accuracy: 0.9622 - val_loss: 0.1043 - val_accuracy: 0.9589
Epoch 35/100
105/105 [==============================] - 31s 294ms/step - loss: 0.1180 - accuracy: 0.9607 - val_loss: 0.1020 - val_accuracy: 0.9589
Epoch 36/100
105/105 [==============================] - 31s 295ms/step - loss: 0.1108 - accuracy: 0.9604 - val_loss: 0.1169 - val_accuracy: 0.9545
Epoch 37/100
105/105 [==============================] - 31s 294ms/step - loss: 0.1141 - accuracy: 0.9589 - val_loss: 0.1127 - val_accuracy: 0.9634
Epoch 38/100
105/105 [==============================] - 31s 295ms/step - loss: 0.1160 - accuracy: 0.9554 - val_loss: 0.1008 - val_accuracy: 0.9643
Epoch 39/100
105/105 [==============================] - 32s 307ms/step - loss: 0.1003 - accuracy: 0.9604 - val_loss: 0.1163 - val_accuracy: 0.9616
Epoch 40/100
105/105 [==============================] - 31s 294ms/step - loss: 0.1050 - accuracy: 0.9613 - val_loss: 0.1048 - val_accuracy: 0.9679
Epoch 41/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.0948 - accuracy: 0.9627INFO:tensorflow:Assets written to: model-041.model\assets
105/105 [==============================] - 33s 315ms/step - loss: 0.0942 - accuracy: 0.9631 - val_loss: 0.0902 - val_accuracy: 0.9661
Epoch 42/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.1027 - accuracy: 0.9642INFO:tensorflow:Assets written to: model-042.model\assets
105/105 [==============================] - 33s 313ms/step - loss: 0.1026 - accuracy: 0.9640 - val_loss: 0.0798 - val_accuracy: 0.9732
Epoch 43/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0928 - accuracy: 0.9658 - val_loss: 0.0940 - val_accuracy: 0.9643
Epoch 44/100
105/105 [==============================] - 31s 293ms/step - loss: 0.0888 - accuracy: 0.9702 - val_loss: 0.0875 - val_accuracy: 0.9759
Epoch 45/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0964 - accuracy: 0.9667 - val_loss: 0.1205 - val_accuracy: 0.9509
Epoch 46/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0929 - accuracy: 0.9673 - val_loss: 0.0832 - val_accuracy: 0.9705
Epoch 47/100
105/105 [==============================] - 31s 293ms/step - loss: 0.0850 - accuracy: 0.9714 - val_loss: 0.1034 - val_accuracy: 0.9589
Epoch 48/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0808 - accuracy: 0.9676 - val_loss: 0.1152 - val_accuracy: 0.9518
Epoch 49/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0842 - accuracy: 0.9676 - val_loss: 0.0965 - val_accuracy: 0.9688
Epoch 50/100
105/105 [==============================] - 31s 297ms/step - loss: 0.0832 - accuracy: 0.9682 - val_loss: 0.0813 - val_accuracy: 0.9679
Epoch 51/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0852 - accuracy: 0.9682 - val_loss: 0.0955 - val_accuracy: 0.9652
Epoch 52/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.0811 - accuracy: 0.9694INFO:tensorflow:Assets written to: model-052.model\assets
105/105 [==============================] - 33s 314ms/step - loss: 0.0806 - accuracy: 0.9696 - val_loss: 0.0781 - val_accuracy: 0.9723
Epoch 53/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0815 - accuracy: 0.9664 - val_loss: 0.0929 - val_accuracy: 0.9634
Epoch 54/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.0765 - accuracy: 0.9718INFO:tensorflow:Assets written to: model-054.model\assets
105/105 [==============================] - 33s 313ms/step - loss: 0.0766 - accuracy: 0.9717 - val_loss: 0.0748 - val_accuracy: 0.9812
Epoch 55/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0886 - accuracy: 0.9679 - val_loss: 0.0824 - val_accuracy: 0.9741
Epoch 56/100
105/105 [==============================] - 31s 293ms/step - loss: 0.0696 - accuracy: 0.9762 - val_loss: 0.0814 - val_accuracy: 0.9696
Epoch 57/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0655 - accuracy: 0.9768 - val_loss: 0.0786 - val_accuracy: 0.9786
Epoch 58/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0736 - accuracy: 0.9735 - val_loss: 0.0779 - val_accuracy: 0.9732
Epoch 59/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0764 - accuracy: 0.9735 - val_loss: 0.0868 - val_accuracy: 0.9714
Epoch 60/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.0678 - accuracy: 0.9775INFO:tensorflow:Assets written to: model-060.model\assets
105/105 [==============================] - 33s 311ms/step - loss: 0.0674 - accuracy: 0.9777 - val_loss: 0.0673 - val_accuracy: 0.9777
Epoch 61/100
105/105 [==============================] - 32s 304ms/step - loss: 0.0635 - accuracy: 0.9768 - val_loss: 0.0897 - val_accuracy: 0.9688
Epoch 62/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0747 - accuracy: 0.9726 - val_loss: 0.1042 - val_accuracy: 0.9598
Epoch 63/100
104/105 [============================&gt;.] - ETA: 0s - loss: 0.0676 - accuracy: 0.9772INFO:tensorflow:Assets written to: model-063.model\assets
105/105 [==============================] - 33s 315ms/step - loss: 0.0680 - accuracy: 0.9768 - val_loss: 0.0640 - val_accuracy: 0.9812
Epoch 64/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0614 - accuracy: 0.9756 - val_loss: 0.0679 - val_accuracy: 0.9786
Epoch 65/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0642 - accuracy: 0.9759 - val_loss: 0.0784 - val_accuracy: 0.9723
Epoch 66/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0627 - accuracy: 0.9753 - val_loss: 0.1004 - val_accuracy: 0.9696
Epoch 67/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0665 - accuracy: 0.9738 - val_loss: 0.0983 - val_accuracy: 0.9661
Epoch 68/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0651 - accuracy: 0.9765 - val_loss: 0.0667 - val_accuracy: 0.9768
Epoch 69/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0619 - accuracy: 0.9786 - val_loss: 0.0705 - val_accuracy: 0.9786
Epoch 70/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0630 - accuracy: 0.9777 - val_loss: 0.0834 - val_accuracy: 0.9723
Epoch 71/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0603 - accuracy: 0.9795 - val_loss: 0.0802 - val_accuracy: 0.9723
Epoch 72/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0708 - accuracy: 0.9735 - val_loss: 0.0834 - val_accuracy: 0.9723
Epoch 73/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0521 - accuracy: 0.9827 - val_loss: 0.0671 - val_accuracy: 0.9759
Epoch 74/100
105/105 [==============================] - 31s 296ms/step - loss: 0.0626 - accuracy: 0.9777 - val_loss: 0.0737 - val_accuracy: 0.9759
Epoch 75/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0585 - accuracy: 0.9810 - val_loss: 0.0701 - val_accuracy: 0.9804
Epoch 76/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0568 - accuracy: 0.9807 - val_loss: 0.0785 - val_accuracy: 0.9741
Epoch 77/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0546 - accuracy: 0.9821 - val_loss: 0.0817 - val_accuracy: 0.9705
Epoch 78/100
105/105 [==============================] - 31s 296ms/step - loss: 0.0572 - accuracy: 0.9812 - val_loss: 0.0825 - val_accuracy: 0.9723
Epoch 79/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0509 - accuracy: 0.9795 - val_loss: 0.0717 - val_accuracy: 0.9812
Epoch 80/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0552 - accuracy: 0.9830 - val_loss: 0.0778 - val_accuracy: 0.9732
Epoch 81/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0502 - accuracy: 0.9815 - val_loss: 0.0810 - val_accuracy: 0.9723
Epoch 82/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0499 - accuracy: 0.9812 - val_loss: 0.0919 - val_accuracy: 0.9705
Epoch 83/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0496 - accuracy: 0.9818 - val_loss: 0.0906 - val_accuracy: 0.9670
Epoch 84/100
105/105 [==============================] - 31s 297ms/step - loss: 0.0482 - accuracy: 0.9827 - val_loss: 0.0806 - val_accuracy: 0.9786
Epoch 85/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0536 - accuracy: 0.9789 - val_loss: 0.0902 - val_accuracy: 0.9723
Epoch 86/100
105/105 [==============================] - 31s 293ms/step - loss: 0.0502 - accuracy: 0.9827 - val_loss: 0.0835 - val_accuracy: 0.9696
Epoch 87/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0450 - accuracy: 0.9857 - val_loss: 0.0894 - val_accuracy: 0.9741
Epoch 88/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0598 - accuracy: 0.9792 - val_loss: 0.0895 - val_accuracy: 0.9696
Epoch 89/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0485 - accuracy: 0.9824 - val_loss: 0.0946 - val_accuracy: 0.9679
Epoch 90/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0526 - accuracy: 0.9807 - val_loss: 0.0719 - val_accuracy: 0.9696
Epoch 91/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0432 - accuracy: 0.9845 - val_loss: 0.0735 - val_accuracy: 0.9732
Epoch 92/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0437 - accuracy: 0.9839 - val_loss: 0.1017 - val_accuracy: 0.9670
Epoch 93/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0397 - accuracy: 0.9851 - val_loss: 0.0704 - val_accuracy: 0.9830
Epoch 94/100
105/105 [==============================] - 32s 302ms/step - loss: 0.0481 - accuracy: 0.9836 - val_loss: 0.0811 - val_accuracy: 0.9750
Epoch 95/100
105/105 [==============================] - 31s 294ms/step - loss: 0.0434 - accuracy: 0.9845 - val_loss: 0.0801 - val_accuracy: 0.9777
Epoch 96/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0453 - accuracy: 0.9821 - val_loss: 0.1287 - val_accuracy: 0.9652
Epoch 97/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0478 - accuracy: 0.9824 - val_loss: 0.0670 - val_accuracy: 0.9786
Epoch 98/100
105/105 [==============================] - 32s 307ms/step - loss: 0.0546 - accuracy: 0.9798 - val_loss: 0.0808 - val_accuracy: 0.9741
Epoch 99/100
105/105 [==============================] - 31s 293ms/step - loss: 0.0339 - accuracy: 0.9869 - val_loss: 0.0766 - val_accuracy: 0.9795
Epoch 100/100
105/105 [==============================] - 31s 295ms/step - loss: 0.0385 - accuracy: 0.9866 - val_loss: 0.0935 - val_accuracy: 0.9696</code></pre>
</div>
</div>
<section id="model-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h2>
<div id="cell-21" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T15:24:29.342769Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T15:24:29.214319Z&quot;}" data-execution_count="153">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">15</span>,<span class="dv">6</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'classic'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">0</span>, epochs), history.history[<span class="st">'loss'</span>], label <span class="op">=</span> <span class="st">'Training_Loss'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">0</span>, epochs), history.history[<span class="st">'val_loss'</span>], label <span class="op">=</span> <span class="st">'val_Loss'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">0</span>, epochs), history.history[<span class="st">'accuracy'</span>], label <span class="op">=</span> <span class="st">'train_accuracy'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">0</span>, epochs), history.history[<span class="st">'val_accuracy'</span>], label <span class="op">=</span> <span class="st">'val_accuracy'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'ModelPerformance'</span>, fontsize <span class="op">=</span> <span class="dv">9</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of epochs'</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss/Acc'</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>plt.legend(loc <span class="op">=</span> <span class="st">'center'</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Looking at the graph, we can see our model overfitting after epoch number 63. With the help of callback, I already have best performing model saved in my working directory, so I will use the model with 63 epochs.</p>
<div id="cell-23" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T15:25:27.328922Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T15:25:12.970688Z&quot;}" data-execution_count="157">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>score_val <span class="op">=</span> model.evaluate(X_val, y_val, verbose <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>score_train <span class="op">=</span> model.evaluate(X_train, y_train, verbose <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>score_test <span class="op">=</span> model.evaluate(X_test, y_test, verbose <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-24" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-08-23T15:25:32.023237Z&quot;,&quot;start_time&quot;:&quot;2020-08-23T15:25:32.017228Z&quot;}" data-execution_count="158">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy of Validation : </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>(<span class="bu">round</span>(score_val[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy of train : </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>(<span class="bu">round</span>(score_train[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy of test </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>(<span class="bu">round</span>(score_test[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Loss of Validation : </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(score_val[<span class="dv">0</span>]))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Loss of train : </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(score_train[<span class="dv">0</span>]))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Loss of test </span><span class="sc">{}</span><span class="st"> '</span>.<span class="bu">format</span>(score_test[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy of Validation : 97 %
Accuracy of train : 99 %
Accuracy of test 97 %
Loss of Validation : 0.09353941864267523
Loss of train : 0.021156626015103288
Loss of test 0.12470129030249036 </code></pre>
</div>
</div>
<p>Score shows a sign of overfitting, but with the help of callback, we have the best performing model saved in our directory. We will use that model in our live mask detection.</p>
<div id="cell-26" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:46:00.701272Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:45:58.292255Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bestmodel <span class="op">=</span> load_model(<span class="st">'model-063.model/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-27" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:05:10.696234Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:04:48.547966Z&quot;}" data-execution_count="29">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>score_val_best <span class="op">=</span> bestmodel.evaluate(X_val, y_val, verbose <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>score_train_best <span class="op">=</span> bestmodel.evaluate(X_train, y_train, verbose <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>score_test_best <span class="op">=</span> bestmodel.evaluate(X_test, y_test, verbose <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-28" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:05:15.352399Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:05:15.348409Z&quot;}" data-execution_count="30">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best model Accuracy of Validation : </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>(<span class="bu">round</span>(score_val_best[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best model Accuracy of train : </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>(<span class="bu">round</span>(score_train_best[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best model Accuracy of test </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>(<span class="bu">round</span>(score_test_best[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best model Loss of Validation : </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(score_val_best[<span class="dv">0</span>]))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best model Loss of train : </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(score_train_best[<span class="dv">0</span>]))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best model Loss of test </span><span class="sc">{}</span><span class="st"> '</span>.<span class="bu">format</span>(score_test_best[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best model Accuracy of Validation : 98 %
Best model Accuracy of train : 99 %
Best model Accuracy of test 97 %
Best model Loss of Validation : 0.06396120258473924
Best model Loss of train : 0.03232613244049606
Best model Loss of test 0.12173265422643291 </code></pre>
</div>
</div>
<p>We can clearly see that the results of model with 63 epochs is better than the model with 100 epochs.</p>
</section>
<section id="testing" class="level2">
<h2 class="anchored" data-anchor-id="testing">Testing</h2>
<div id="cell-31" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:46:02.687924Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:46:02.684958Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_file <span class="op">=</span> <span class="st">'res10_300x300_ssd_iter_140000.caffemodel'</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>config_file <span class="op">=</span> <span class="st">'deploy.prototxt.txt'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-32" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T18:46:03.027996Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T18:46:03.000047Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> cv2.dnn.readNetFromCaffe(config_file, model_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-33" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2020-09-04T19:03:34.164545Z&quot;,&quot;start_time&quot;:&quot;2020-09-04T19:03:32.491255Z&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">'Test'</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>test_image_path <span class="op">=</span> os.listdir(path)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"[INFO] Loading Image........"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> img <span class="kw">in</span> test_image_path:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    image_path <span class="op">=</span> os.path.join(path, img)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    image <span class="op">=</span> cv2.imread(image_path)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    image <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_BGR2RGB)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    original <span class="op">=</span> image.copy()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    h, w <span class="op">=</span> image.shape[:<span class="dv">2</span>]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    blob <span class="op">=</span> cv2.dnn.blobFromImage(cv2.resize(image, (<span class="dv">300</span>, <span class="dv">300</span>)), <span class="fl">1.0</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">300</span>, <span class="dv">300</span>), (<span class="fl">104.0</span>, <span class="fl">117.0</span>, <span class="fl">123.0</span>))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    net.setInput(blob)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    faces <span class="op">=</span> net.forward()</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(faces.shape[<span class="dv">2</span>]):</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>            confidence <span class="op">=</span> faces[<span class="dv">0</span>, <span class="dv">0</span>, i, <span class="dv">2</span>]</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> confidence <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                box <span class="op">=</span> faces[<span class="dv">0</span>, <span class="dv">0</span>, i, <span class="dv">3</span>:<span class="dv">7</span>] <span class="op">*</span> np.array([w, h, w, h])</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                (startX, startY, endX, endY) <span class="op">=</span> box.astype(<span class="st">"int"</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                (startX, startY) <span class="op">=</span> (<span class="bu">max</span>(<span class="dv">0</span>, startX), <span class="bu">max</span>(<span class="dv">0</span>, startY))</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                (endX, endY) <span class="op">=</span> (<span class="bu">min</span>(w <span class="op">-</span> <span class="dv">1</span>, endX), <span class="bu">min</span>(h <span class="op">-</span> <span class="dv">1</span>, endY))</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'[INFO] Extracting Face Location'</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                face <span class="op">=</span> image[startY:endY, startX:endX]</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                face <span class="op">=</span> cv2.resize(face, (<span class="dv">224</span>, <span class="dv">224</span>))</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                face <span class="op">=</span> img_to_array(face)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>                face <span class="op">=</span> preprocess_input(face)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>                face <span class="op">=</span> np.expand_dims(face, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'[INFO] Predicting........'</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>                mask, nomask <span class="op">=</span> bestmodel.predict(face)[<span class="dv">0</span>]</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>                prediction <span class="op">=</span> bestmodel.predict(face)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> np.argmax(prediction, axis <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>                label <span class="op">=</span> <span class="st">"Mask"</span> <span class="cf">if</span> result <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"No Mask"</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>) <span class="cf">if</span> label <span class="op">==</span> <span class="st">"Mask"</span> <span class="cf">else</span> (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>                cv2.putText(image, label, (startX, startY <span class="op">-</span> <span class="dv">10</span>),cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.45</span>, color, <span class="dv">2</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                cv2.rectangle(image, (startX, startY), (endX, endY), color, <span class="dv">2</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))            </span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    plt.imshow(image)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"Image 1"</span>)</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[INFO] Loading Image........
[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-22-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[INFO] Extracting Face Location
[INFO] Predicting........</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-22-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-22-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-22-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-22-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........
[INFO] Extracting Face Location
[INFO] Predicting........</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Mask Detection_files/figure-html/cell-22-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Looking at the pictures above, we can say that our model performed well overall. In this first image, dnn caffe model failed to detect face location so our model was unable to predict. In live environment, model sometimes make wrong predictions when the brightness on the face is extremely high. Improvements can be made by including high brightness images to the training. Thank you for checking out my kernel</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Copyright 2025, Uzair Ahmed</p>
</div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>